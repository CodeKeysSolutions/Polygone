(()=>{"use strict";var e={585:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ClockedPlayers=void 0;const n=t(586),i=t(483),a=t(611);t(82),s.ClockedPlayers={},onNet("fw-businesses:Server:SetClock",(e=>{const t=source;e.ClockInTime=GetGameTimer(),s.ClockedPlayers[t]=e})),on("playerDropped",(e=>{const t=source;s.ClockedPlayers[t]={Business:"",ClockedIn:!1,ClockInTime:0}})),s.default=()=>{i.FW.Functions.CreateCallback("fw-businesses:Server:GetBusinessesByPlayer",(async(e,s)=>{const t=i.FW.Functions.GetPlayer(e);if(!t)return s([]);const r=[],o=await n.exp.ghmattimysql.executeSync("SELECT * FROM `phone_businesses` WHERE `business_employees` LIKE ? OR `business_owner` = ?",[`%${t.PlayerData.citizenid}%`,t.PlayerData.citizenid]);for(let e=0;e<o.length;e++){const s=o[e];let t=[],n=JSON.parse(s.business_employees);for(let e=0;e<n.length;e++){const s=n[e],i=await(0,a.GetPlayerNameByCid)(s.Cid);i&&t.push({...s,Name:i})}r.push({...s,business_employees:t,business_ranks:JSON.parse(s.business_ranks),owner_name:await(0,a.GetPlayerNameByCid)(s.business_owner)})}s(r)})),i.FW.Functions.CreateCallback("fw-businesses:Server:GetBusinessByName",(async(e,s,t)=>{s(await(0,a.GetBusinessByName)(t))})),i.FW.Functions.CreateCallback("fw-businesses:Server:AddEmployee",(async(e,s,t,r,o)=>{if(!i.FW.Functions.GetPlayer(e))return s({Success:!1,Msg:"Invalid player."});const c=await(0,a.GetBusinessByName)(t);if(!c)return s({Success:!1,Msg:"Invalid business."});if(!(await n.exp.ghmattimysql.executeSync("SELECT `citizenid` FROM `players` WHERE `citizenid` = ?",[r]))[0])return s({Success:!1,Msg:"Invalid player."});const l=JSON.parse(c.business_employees)||[];if(-1!=l.findIndex((e=>e.Cid==r)))return s({Success:!1,Msg:"Player is already an employee"});l.push({Cid:r,Role:o}),await n.exp.ghmattimysql.executeSync("UPDATE `phone_businesses` SET `business_employees` = ? WHERE `business_name` = ?",[JSON.stringify(l),t]);let u=[];for(let e=0;e<l.length;e++){const s=l[e],t=await(0,a.GetPlayerNameByCid)(s.Cid);t&&u.push({...s,Name:t})}s({Success:!0,Employees:u})})),i.FW.Functions.CreateCallback("fw-businesses:Server:SetEmployeeRank",(async(e,s,t,r,o)=>{if(!i.FW.Functions.GetPlayer(e))return s({Success:!1,Msg:"Invalid player."});const c=await(0,a.GetBusinessByName)(t);if(!c)return s({Success:!1,Msg:"Invalid business."});if(!(await n.exp.ghmattimysql.executeSync("SELECT `citizenid` FROM `players` WHERE `citizenid` = ?",[r]))[0])return s({Success:!1,Msg:"Invalid player."});const l=JSON.parse(c.business_employees)||[],u=l.findIndex((e=>e.Cid==r));if(-1==u)return s({Success:!1,Msg:"Player is not an employee"});l[u].Role=o,await n.exp.ghmattimysql.executeSync("UPDATE `phone_businesses` SET `business_employees` = ? WHERE `business_name` = ?",[JSON.stringify(l),t]);let y=[];for(let e=0;e<l.length;e++){const s=l[e],t=await(0,a.GetPlayerNameByCid)(s.Cid);t&&y.push({...s,Name:t})}s({Success:!0,Employees:y})})),i.FW.Functions.CreateCallback("fw-businesses:Server:RemoveEmployee",(async(e,s,t,r)=>{if(!i.FW.Functions.GetPlayer(e))return s({Success:!1,Msg:"Invalid player."});const o=await(0,a.GetBusinessByName)(t);if(!o)return s({Success:!1,Msg:"Invalid business."});if(!(await n.exp.ghmattimysql.executeSync("SELECT `citizenid` FROM `players` WHERE `citizenid` = ?",[r]))[0])return s({Success:!1,Msg:"Invalid player."});let c=JSON.parse(o.business_employees)||[];if(-1==c.findIndex((e=>e.Cid==r)))return s({Success:!1,Msg:"Player is not an employee"});c=c.filter((e=>e.Cid!=r)),await n.exp.ghmattimysql.executeSync("UPDATE `phone_businesses` SET `business_employees` = ? WHERE `business_name` = ?",[JSON.stringify(c),t]);let l=[];for(let e=0;e<c.length;e++){const s=c[e],t=await(0,a.GetPlayerNameByCid)(s.Cid);t&&l.push({...s,Name:t})}s({Success:!0,Employees:l})})),i.FW.Functions.CreateCallback("fw-businesses:Server:CreateRole",(async(e,s,t,r,o)=>{if(!i.FW.Functions.GetPlayer(e))return s({Success:!1,Msg:"Invalid player"});const c=await(0,a.GetBusinessByName)(t);if(!c)return s({Success:!1,Msg:"Invalid business"});if(0==r.trim().length)return s({Success:!1,Msg:"Invalid role."});const l=JSON.parse(c.business_ranks);if(-1!=l.findIndex((e=>e.Name.toLowerCase()==r.toLowerCase())))return s({Success:!1,Msg:"Role already exists."});l.push({Name:r,Perms:{Hire:!!o.Hire,Fire:!!o.Fire,ChangeRole:!!o.ChangeRole,PayEmployee:!!o.PayEmployee,PayExternal:!!o.PayExternal,ChargeExternal:!!o.ChargeExternal,PropertyKeys:!!o.PropertyKeys,StashAccess:!!o.StashAccess,CraftAccess:!!o.CraftAccess,VehicleSales:!!o.VehicleSales}}),await n.exp.ghmattimysql.executeSync("UPDATE `phone_businesses` SET `business_ranks` = ? WHERE `business_name` = ?",[JSON.stringify(l),t]),s({Success:!0,Ranks:l})})),i.FW.Functions.CreateCallback("fw-businesses:Server:EditRole",(async(e,s,t,r,o)=>{if(!i.FW.Functions.GetPlayer(e))return s({Success:!1,Msg:"Invalid player"});const c=await(0,a.GetBusinessByName)(t);if(!c)return s({Success:!1,Msg:"Invalid business"});if(0==r.trim().length)return s({Success:!1,Msg:"Invalid role."});const l=JSON.parse(c.business_ranks),u=l.findIndex((e=>e.Name.toLowerCase()==r.toLowerCase()));if(-1==u)return s({Success:!1,Msg:"Role does not exist."});l[u].Perms={Hire:!!o.Hire,Fire:!!o.Fire,ChangeRole:!!o.ChangeRole,PayEmployee:!!o.PayEmployee,PayExternal:!!o.PayExternal,ChargeExternal:!!o.ChargeExternal,PropertyKeys:!!o.PropertyKeys,StashAccess:!!o.StashAccess,CraftAccess:!!o.CraftAccess,VehicleSales:!!o.VehicleSales},await n.exp.ghmattimysql.executeSync("UPDATE `phone_businesses` SET `business_ranks` = ? WHERE `business_name` = ?",[JSON.stringify(l),t]),s({Success:!0,Ranks:l})})),i.FW.Functions.CreateCallback("fw-businesses:Server:Delete",(async(e,s,t,r)=>{if(!i.FW.Functions.GetPlayer(e))return s({Success:!1,Msg:"Invalid player"});const o=await(0,a.GetBusinessByName)(t);if(!o)return s({Success:!1,Msg:"Invalid business"});if(0==r.trim().length)return s({Success:!1,Msg:"Invalid role."});if(-1!=JSON.parse(o.business_employees).findIndex((e=>e.Role.toLowerCase()==r.toLowerCase())))return s({Success:!1,Msg:"An employee has this role."});let c=JSON.parse(o.business_ranks);c=c.filter((e=>e.Name.toLowerCase()!=r.toLowerCase())),await n.exp.ghmattimysql.executeSync("UPDATE `phone_businesses` SET `business_ranks` = ? WHERE `business_name` = ?",[JSON.stringify(c),t]),s({Success:!0,Ranks:c})})),i.FW.Functions.CreateCallback("fw-businesses:Server:HasPlayerBusinessPermission",(async(e,s,t,n)=>{s(await(0,a.HasPlayerBusinessPermission)(t,e,n))}))},(0,n.exp)("GetClockedInPlayers",(()=>s.ClockedPlayers))},84:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0});const n=t(586),i=t(483);let a={};const r=[{Item:"vehicle-clutch",Type:"Clutch"},{Item:"vehicle-axle",Type:"Axle"},{Item:"vehicle-brakes",Type:"Brakes"},{Item:"vehicle-engine",Type:"Engine"},{Item:"vehicle-injectors",Type:"FuelInjectors"},{Item:"vehicle-transmission",Type:"Transmission"}];for(let e=0;e<r.length;e++){const{Item:s,Type:t}=r[e];i.FW.Functions.CreateUsableItem(s,(async(e,n)=>{const a=i.FW.Functions.GetPlayer(e);await a.Functions.GetItemBySlot(n.Slot)&&emitNet("fw-businesses:Client:AutoCare:MountPart",e,s,t,n.CustomType)}))}const o=async e=>{const s=a[e];s&&(n.exp.ghmattimysql.execute("UPDATE `player_vehicles` SET `parts` = ? WHERE `plate` = ? LIMIT 1",[JSON.stringify(s),e]),emitNet("fw-businesses:Client:AutoCare:SyncVehicleParts",-1,e,s))};i.FW.Functions.CreateCallback("fw-businesses:Server:AutoCare:GetAllParts",((e,s)=>{s(a)})),i.FW.Functions.CreateCallback("fw-businesses:Server:AutoCare:GetNewPercentage",((e,s,t,a,r,o)=>{const c=i.FW.Functions.GetPlayer(e);if(!c)return;let l=n.exp["fw-vehicles"].GetVehicleMeta(o,t),u=0;switch(t){case"Harness":u=n.exp["fw-inventory"].CalculateQuality("harness",a),l+=u,n.exp["fw-vehicles"].SetVehicleMeta(o,"Harness",l>100?100:l),c.Functions.RemoveItem("harness",1,r,!0);break;case"Nitrous":u=n.exp["fw-inventory"].CalculateQuality("nitrous",a),l+=u,n.exp["fw-vehicles"].SetVehicleMeta(o,"Nitrous",l>100?100:l),c.Functions.RemoveItem("nitrous",1,r,!0)}s(l>100?100:l)})),onNet("fw-businesses:Server:AutoCare:LoadParts",(async e=>{const s=await(async e=>{const s=await n.exp.ghmattimysql.executeSync("SELECT `parts` FROM `player_vehicles` WHERE `plate` = ? LIMIT 1",[e]);return s[0]&&s[0].parts&&JSON.parse(s[0].parts)||void 0})(e);s&&(a[e]=s,emitNet("fw-businesses:Client:AutoCare:SyncVehicleParts",-1,e,s))})),onNet("fw-businesses:Server:AutoCare:RepairPart",(async(e,s)=>{void 0!==a[e]&&(a[e][s]=100,o(e))})),onNet("fw-businesses:Server:AutoCare:ApplyPartDamage",(async(e,s,t)=>{const r=i.FW.Shared.HashVehicles[s];if(!r)return;let c=1;if("Body"==t&&(c=1.6),"A"==r.Class&&(c+=.2),"B"==r.Class&&(c+=.4),"C"==r.Class&&(c+=.6),"D"==r.Class&&(c+=.8),"E"==r.Class&&(c+=1),"M"==r.Class&&(c+=1.2),!a[e])return;const l=Object.keys(a[e]);for(let s=0;s<l.length;s++){const t=l[s];a[e][t]-=.6+c+(0,n.GetRandom)(40,130)/100}o(e)}))},16:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0});const n=t(586),i=t(483),a=t(104);i.FW.Functions.CreateCallback("fw-businesses:Server:BicycleShop:Purchase",(async(e,s,t,r,o,c)=>{const l=i.FW.Functions.GetPlayer(e);if(!l)return;if(!l.Functions.RemoveMoney("cash",i.FW.Shared.CalculateTax("Vehicle Registration Tax",r),"Purchased Bicycle"))return void s({Success:!1});const u=await i.FW.Functions.GeneratePlate(),y=i.FW.Functions.SpawnVehicle(e,t,{x:c.x,y:c.y,z:c.z+1.5,a:c.w},!1,u),m=NetworkGetEntityFromNetworkId(y);for(;!DoesEntityExist(m);)await(0,n.Delay)(25);if(SetEntityHeading(m,c.w+0),!o){const e=i.FW.Shared.HashVehicles[GetHashKey(t)],s=await i.FW.Functions.GenerateVin(),o=new Date,c=o.getFullYear(),y=o.getMonth(),m=o.getDate(),f=o.getHours(),d=o.getMinutes();let h=[e.Name,t,u,s,`${l.PlayerData.charinfo.firstname} ${l.PlayerData.charinfo.lastname}`,"Skelet Spoke",`${m}/${y}/${c} ${f}:${d}`,(0,n.NumberWithCommas)(r)];emit("fw-phone:Server:Documents:AddDocument","1001",{Type:3,Title:`${e.Name} - ${u}`,Content:a.VehicleRegistration.replace(/%s/g,(()=>h.shift()||"")),Signatures:[{Signed:!0,Name:"De Staat",Timestamp:o.getTime(),Cid:"1001"},{Signed:!0,Name:`${l.PlayerData.charinfo.firstname} ${l.PlayerData.charinfo.lastname}`,Timestamp:o.getTime(),Cid:l.PlayerData.citizenid}],Sharees:[l.PlayerData.citizenid],Finalized:1})}s({Success:!0,Plate:u,NetId:y})}))},258:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IsItemScrappable=void 0;const n=t(586),i=t(483),a=t(611);s.IsItemScrappable=(e,s)=>{const t=e.findIndex((e=>e.Item==s));return-1!==t&&e[t]},i.FW.Functions.CreateCallback("fw-businesses:Server:Electronics:GetScrapItems",(async(e,t,r)=>{if(!n.exp["fw-config"].IsConfigReady())return t([]);const o=i.FW.Functions.GetPlayer(e);if(!o)return;if(!await(0,a.HasPlayerBusinessPermission)(r,e,"CraftAccess"))return t([]);const c=await n.exp.ghmattimysql.executeSync("SELECT * FROM `player_inventories` WHERE `inventory` = ?",[`ply-${o.PlayerData.citizenid}`]),l=[],{allowDecayedScrap:u,scrapItems:y}=n.exp["fw-config"].GetModuleConfig("bus-electronics",{});if(!y||0==y.length)return t([]);for(let e=0;e<c.length;e++){const t=c[e];if(!t)continue;const i=(0,s.IsItemScrappable)(y,t.item_name);if(!i)continue;const a=n.exp["fw-inventory"].CalculateQuality(t.item_name,t.createdate);!u&&a<=5||l.push({Label:i.Label,Slot:t.slot,Parts:4-Math.floor((100-a)/33),Materials:Math.floor((100-a)/100*75)})}t(l)})),onNet("fw-businesses:Server:Electronics:ScrapElectronic",(async e=>{if(!n.exp["fw-config"].IsConfigReady())return;const t=source,r=i.FW.Functions.GetPlayer(t);if(!r)return;if(!await(0,a.HasPlayerBusinessPermission)(e.Business,t,"CraftAccess"))return;const{scrapItems:o}=n.exp["fw-config"].GetModuleConfig("bus-electronics"),c=await n.exp["fw-inventory"].GetInventoryItemBySlot(`ply-${r.PlayerData.citizenid}`,e.Slot);if(!c)return;const l=(0,s.IsItemScrappable)(o,c.Item);if(!l)return;const u=(0,n.GetRandom)(l.Rewards[0],l.Rewards[1]);await r.Functions.RemoveItem(c.Item,1,e.Slot,!0)&&(await(0,n.Delay)(10),r.Functions.AddItem("electronics",u*e.Parts,!1,!1,!0,!1))})),onNet("fw-businesses:Server:Electronics:RepairElectronic",(async e=>{if(!n.exp["fw-config"].IsConfigReady())return;const t=source,r=i.FW.Functions.GetPlayer(t);if(!r)return;if(!await(0,a.HasPlayerBusinessPermission)(e.Business,t,"CraftAccess"))return;const{scrapItems:o}=n.exp["fw-config"].GetModuleConfig("bus-electronics"),c=await n.exp["fw-inventory"].GetInventoryItemBySlot(`ply-${r.PlayerData.citizenid}`,e.Slot);c&&(0,s.IsItemScrappable)(o,c.Item)&&(await r.Functions.RemoveItemByName("electronics",e.Materials,!0)?(n.exp["fw-inventory"].IncreaseQualityItemFromInventory(`ply-${r.PlayerData.citizenid}`,c.Item,100,e.Slot),r.Functions.Notify("Repaired!")):r.Functions.Notify("Not enough electronics..","error"))})),onNet("fw-businesses:Server:Electronics:RemoveMusicEntry",(async e=>{const s=source,t=i.FW.Functions.GetPlayer(s);if(t){if(!(0,a.HasPlayerBusinessPermission)(e.Business,s,"CraftAccess"))return t.Functions.Notify("No access.","error");await n.exp.ghmattimysql.executeSync("DELETE FROM `musictapes` WHERE `id` = ?",[e.TrackId]),t.Functions.Notify("Track removed!"),setTimeout((()=>{emitNet("fw-businesses:Client:Electronics:ManageMusicEntries",s,{Business:e.Business})}),150),emit("fw-logs:Server:Log","musictapes","Track Entry Deleted",`User: [${t.PlayerData.source}] - ${t.PlayerData.citizenid} - ${t.PlayerData.charinfo.firstname} ${t.PlayerData.charinfo.lastname}\nEntry Id: ${e.TrackId}`,"red")}})),i.FW.RegisterServer("fw-businesses:Server:Electronics:AddMusicEntry",(async(e,s)=>{const t=i.FW.Functions.GetPlayer(e);if(!t)return;if(!(0,a.HasPlayerBusinessPermission)(s.Business,e,"CraftAccess"))return t.Functions.Notify("Geen toegang.","error");const r=await n.exp.ghmattimysql.executeSync("INSERT INTO `musictapes` (tape_id, tape_title, tape_artist) VALUES (?, ?, ?)",[s.TapeId,s.Title,s.Artist]);TriggerEvent("fw-logs:Server:Log","musictapes","Track Entry Added",`User: [${t.PlayerData.source}] - ${t.PlayerData.citizenid} - ${t.PlayerData.charinfo.firstname} ${t.PlayerData.charinfo.lastname}\nEntry ID: ${r.insertId}\nSoundcloud Track Id: [${s.TapeId}](https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/${s.TapeId}&color=%232cffb8&auto_play=true&hide_related=true&show_comments=false&show_user=false&show_reposts=false&show_teaser=false)\nTape: ${s.Artist} - ${s.Title}`,"green")})),i.FW.RegisterServer("fw-businesses:Server:Electronics:CreateCassetteTapes",(async(e,s)=>{const t=i.FW.Functions.GetPlayer(e);if(!t)return;if(!(0,a.HasPlayerBusinessPermission)(s.Business,e,"CraftAccess"))return t.Functions.Notify("No access.","error");const r=await n.exp.ghmattimysql.executeSync("SELECT * FROM `musictapes` WHERE `id` = ?",[s.TrackId]);if(!r[0])return t.Functions.Notify("Invalid track..");for(let e=0;e<s.Copies;e++)t.Functions.AddItem("musictape",1,void 0,{Artist:r[0].tape_artist,Title:r[0].tape_title,_TrackId:r[0].tape_id},!0)})),i.FW.Functions.CreateCallback("fw-businesses:Server:Electronics:GetMusicEntries",(async(e,s)=>{i.FW.Functions.GetPlayer(e)&&s(await n.exp.ghmattimysql.executeSync("SELECT * FROM `musictapes`"))}))},722:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0});const n=t(586),i=t(483),a=t(611),r=e=>n.exp["fw-cityhall"].GetLicenseTemplate().replace(/%s/g,(()=>e.shift()||""));i.FW.Functions.CreateCallback("fw-businesses:Server:Flightschool:GivePilotLicense",(async(e,s,t)=>{const o=i.FW.Functions.GetPlayer(e);if(!o)return s({Success:!1,Msg:"Invalid player."});const c=i.FW.Functions.GetPlayerByCitizenId(t.Cid);if(!c)return s({Success:!1,Msg:"Invalid player."});if(!await(0,a.HasPlayerBusinessPermission)("Los Santos Flight School",e,"ChargeExternal"))return s({Success:!1,Msg:"No access."});if(t.Give){const e=new Date,s=e.getFullYear(),t=e.getMonth(),n=e.getDate(),i=e.getHours(),a=e.getMinutes();emit("fw-phone:Server:Documents:AddDocument","1001",{Type:1,Title:`Pilot License - ${c.PlayerData.citizenid}`,Content:r([`${c.PlayerData.charinfo.firstname} ${c.PlayerData.charinfo.lastname}`,c.PlayerData.citizenid,0==c.PlayerData.charinfo.gender?"Male":"Female",`${o.PlayerData.charinfo.firstname} ${o.PlayerData.charinfo.lastname}`,`${n}/${t+1}/${s} ${i}:${a}`]),Signatures:[{Signed:!0,Name:"The State",Timestamp:e.getTime(),Cid:"1001"}],Sharees:[c.PlayerData.citizenid],Finalized:1})}else n.exp.ghmattimysql.executeSync("DELETE FROM `phone_documents` WHERE `type` = 1 AND `title` = ? AND `sharees` LIKE ?",[`Pilot License - ${c.PlayerData.citizenid}`,`%${c.PlayerData.citizenid}%`]);c.Functions.SetMetaDataTable("licenses","flying",t.Give),s({Success:!0})}))},755:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0});const n=t(586),i=t(483),a=t(611);let r={},o={};i.FW.RegisterServer("fw-businesses:Server:Foodchain:SetPaymentData",(async(e,s,t,n,r)=>{const c=i.FW.Functions.GetPlayer(e);if(c){if(!await(0,a.HasPlayerBusinessPermission)(s,e,"ChargeExternal"))return c.Functions.Notify("No access..","error");o[s]||(o[s]=[]),o[s][t-1]={Order:n,Costs:i.FW.Shared.CalculateTax("Services",r),CostsWithoutTax:r,Employee:{Name:`${c.PlayerData.charinfo.firstname} ${c.PlayerData.charinfo.lastname}`,Cid:c.PlayerData.citizenid,Source:e}}}})),i.FW.Functions.CreateCallback("fw-businesses:Server:Foodchain:GetPaymentData",((e,s,t,n)=>o[t]&&o[t][n-1]?void s(o[t][n-1]):s(!1))),onNet("fw-businesses:Server:Foodchain:PayRegister",(async e=>{const s=i.FW.Functions.GetPlayer(source);if(!s)return;if(!o[e.Business])return;const t=o[e.Business][e.RegisterId-1];if(!t)return;const r=await(0,a.GetBusinessAccount)(e.Business);"Cash"==e.PaymentType&&s.Functions.RemoveMoney("cash",t.Costs)||"Bank"==e.PaymentType&&n.exp["fw-financials"].RemoveMoneyFromAccount(t.Employee.Cid,r,s.PlayerData.charinfo.account,t.Costs,"PURCHASE",`Business service payment: ${t.Order}`,!1)?("Bank"==e.PaymentType&&emitNet("fw-phone:Client:Notification",s.PlayerData.source,`business-pay-${e.Business}-${e.RegisterId}`,"fas fa-home",["white","rgb(38, 50, 56)"],e.Business,`${(0,n.NumberWithCommas)(t.Costs)} deducted from your bank account.`),emitNet("fw-phone:Client:Notification",t.Employee.Source,`business-payment-${e.Business}-${e.RegisterId}`,"fas fa-home",["white","rgb(38, 50, 56)"],e.Business,`${(0,n.NumberWithCommas)(t.Costs)} was successfully deducted.`),n.exp["fw-financials"].AddMoneyToAccount(s.PlayerData.citizenid,s.PlayerData.charinfo.account,r,t.CostsWithoutTax,"PURCHASE",`Business service payment: ${t.Order}`,!1),n.exp["fw-financials"].AddMoneyToAccount("1001","1","1",t.Costs-t.CostsWithoutTax,"TAX",`Services Tax. (${e.Business}: ${(0,n.NumberWithCommas)(t.Costs)})`,!1),o[e.Business][e.RegisterId-1]=!1,emitNet("fw-businesses:Client:Foodchain:RecieveReceipt",-1,e.Business,{Check:"Penis Twister 9000"})):s.Functions.Notify("You do not have enough money..","error")})),onNet("fw-businesses:Server:ReceiveReceipt",(e=>{if("Penis Twister 9000"!=e.Check)return;const s=i.FW.Functions.GetPlayer(source);s&&s.Functions.AddItem("business-ticket",1,!1,!1,!0)})),onNet("fw-businesses:Server:SellReceipts",(async()=>{const e=i.FW.Functions.GetPlayer(source);if(!e)return;const s=await n.exp.ghmattimysql.executeSync("SELECT item_name, custom_type, slot, createdate FROM `player_inventories` WHERE `inventory` = ?",[`ply-${e.PlayerData.citizenid}`]);let t=0;for(let i=0;i<s.length;i++)"business-ticket"==s[i].item_name&&(e.Functions.RemoveItemByName("business-ticket",1,!1),t+=(0,n.GetRandom)(55,75));t>0&&(e.Functions.Notify("Balance has been added to your bank."),n.exp["fw-financials"].AddMoneyToAccount("1001","1",e.PlayerData.charinfo.account,t,"DEPOSIT","Job: Receipt sales"))})),i.FW.RegisterServer("fw-businesses:Server:Foodchain:FinishMeal",(async(e,s,t)=>{const a=i.FW.Functions.GetPlayer(e);if(!a)return;const{ingredientCategories:r,foodchainBuffs:o}=await n.exp["fw-config"].GetModuleConfig("bus-foodchains");for(let e=0;e<t.ingredients.length;e++){const s=t.ingredients[e];for(let e=0;e<r[s].length&&!a.Functions.RemoveItemByName("ingredient",1,!0,r[s][e]);e++);}const c=o[s];a.Functions.AddItem(t.item,1,!1,{Buff:c?c[Math.floor(Math.random()*c.length)]:void 0,BuffPercentage:(0,n.GetRandom)(10,25)},!0,t.dish_id)})),i.FW.Functions.CreateCallback("fw-businesses:Server:Foodchain:GetDishes",((e,s,t,n)=>{if(!r[t]||!r[t][n])return s([]);s(r[t][n])}));const c=/https:\/\/i\.imgur\.com\/[a-zA-Z0-9]+\.png$/i;i.FW.RegisterServer("fw-businesses:Server:Foodchain:CreateItem",(async(e,s,t,r)=>{const o=i.FW.Functions.GetPlayer(e);if(!o)return;if("Prison"!=r.Business&&await(0,a.GetBusinessOwner)(s)!=o.PlayerData.citizenid)return;const{foodchainIds:l,ingredientsPerDish:u,dishItems:y}=await n.exp["fw-config"].GetModuleConfig("bus-foodchains"),m=`${l[s]}-${r.Name.toLowerCase().replaceAll(" ","-")}`;if(0!=(await n.exp.ghmattimysql.executeSync("SELECT COUNT(*) as Amount FROM `server_customtypes` WHERE `type_id` = ?",[m]))[0].Amount)return o.Functions.Notify("Dish already exists!","error");if(!c.test(r.Image))return o.Functions.Notify("Icon must be an imgur PNG image! (e.g. https://i.imgur.com/SteKs2I.png","error");let f=[];for(let e=0;e<u[t];e++)f.push(r[`Ingredient${e+1}`]);n.exp.ghmattimysql.executeSync("INSERT INTO `businesses_dishes` (`foodchain`, `type`, `dish_id`, `ingredients`) VALUES (?, ?, ?, ?)",[s,t,m,JSON.stringify(f)]),n.exp.ghmattimysql.executeSync("INSERT INTO `server_customtypes` (`item_id`, `type_id`, `label`, `description`, `image`, `craft`, `isExternImage`) VALUES (?, ?, ?, ?, ?, '[]', 1)",[y[t],m,r.Name,r.Description,r.Image]),o.Functions.Notify("Dish added!"),TriggerEvent("fw-logs:Server:Log","menuManagement","Dish Created",`User: [${o.PlayerData.source}] - ${o.PlayerData.citizenid} - ${o.PlayerData.charinfo.firstname} ${o.PlayerData.charinfo.lastname}\nFoodchain: ${s}\nDish Type: ${t}\nData: \`\`\`json\n${JSON.stringify(r,void 0,2)}\`\`\``,"green")})),i.FW.Functions.CreateCallback("fw-businesses:Server:Foodchain:GetItem",(async(e,s,t,i)=>{s(n.exp.ghmattimysql.executeSync("SELECT `label` AS Label, `description` AS Description FROM `server_customtypes` WHERE `item_id` = ? AND `type_id` = ?",[t,i])[0])})),i.FW.Functions.CreateCallback("fw-businesses:Server:Foodchain:GetDBDishes",(async(e,s,t,i)=>{const a=await n.exp.ghmattimysql.executeSync("SELECT * FROM `businesses_dishes` WHERE `foodchain` = ? AND `type` = ?",[t,i]),{dishItems:r}=await n.exp["fw-config"].GetModuleConfig("bus-foodchains");for(let e=0;e<a.length;e++){const s=a[e];a[e].item=r[i],a[e].ingredients=JSON.parse(s.ingredients)}s(a)})),onNet("fw-businesses:Server:Foodchain:DeleteItem",(async e=>{console.log("Hi?");const s=i.FW.Functions.GetPlayer(source);if(s){if("Prison"!=e.Foodchain&&await(0,a.GetBusinessOwner)(e.Foodchain)!=s.PlayerData.citizenid)return s.Functions.Notify("No access..","error");await n.exp.ghmattimysql.executeSync("DELETE FROM `businesses_dishes` WHERE `id` = ?",[e.DishId]),s.Functions.Notify("Dish deleted!")}})),onNet("fw-businesses:Server:Foodchain:GrabBusinessBag",(async e=>{const s=i.FW.Functions.GetPlayer(source);if(!s)return;if(!await(0,a.HasPlayerBusinessPermission)(e.Business,s.PlayerData.source,"ChargeExternal"))return s.Functions.Notify("No access..","error");const t=`bag-${(new Date).getTime()}${(0,n.GetRandom)(1,999999)}`;s.Functions.AddItem("business-bag",1,!1,{BagId:t},!0,e.Type)})),onNet("fw-businesses:Server:Foodchain:GrabBusinessGift",(async e=>{const s=i.FW.Functions.GetPlayer(source);if(s)return(0,a.IsClockedIn)(s.PlayerData.source,e.Business)?void("uwucafe"==e.Type&&s.Functions.AddItem("uwu-mystery-box",1,!1,void 0,!0)):s.Functions.Notify("No access..","error")})),setImmediate((async()=>{const e=await n.exp.ghmattimysql.executeSync("SELECT * FROM `businesses_dishes`"),{dishItems:s}=await n.exp["fw-config"].GetModuleConfig("bus-foodchains");for(let t=0;t<e.length;t++){const n=e[t];r[n.foodchain]||(r[n.foodchain]={}),r[n.foodchain][n.type]||(r[n.foodchain][n.type]=[]),r[n.foodchain][n.type].push({foodchain:n.foodchain,type:n.type,dish_id:n.dish_id,item:s[n.type],ingredients:JSON.parse(n.ingredients)})}console.log(`[FOODCHAIN] Loaded a total of ${e.length} dishes.`)})),onNet("fw-businesses:Server:Foodchain:OpenMystery",(e=>{const s=i.FW.Functions.GetPlayer(source);if(!s)return;const t=["uwu-toy-biker","uwu-toy-business","uwu-toy-burglar","uwu-toy-doctor","uwu-toy-fisher","uwu-toy-maid","uwu-toy-officer","uwu-toy-wizard","uwu-toy-worker"];s.Functions.RemoveItem("uwu-mystery-box",1,e.Slot)&&s.Functions.AddItem(t[Math.floor(Math.random()*t.length)],1,!1,!1,!0)}))},82:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),t(722),t(822),t(104),t(16),t(84),t(258),t(641),t(755)},822:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0});const n=t(483);onNet("fw-businesses:Server:News:PurchaseCamera",(()=>{const e=source,s=n.FW.Functions.GetPlayer(e);if(s)return"news"!=s.PlayerData.job.name?s.Functions.Notify("No access..","error"):s.Functions.RemoveMoney("cash",85,"Purchase News Item")?void s.Functions.AddItem("newscamera",1,!1,void 0,!0):s.Functions.Notify("Not enough cash..","error")})),onNet("fw-businesses:Server:News:PurchaseMic",(()=>{const e=source,s=n.FW.Functions.GetPlayer(e);if(s)return"news"!=s.PlayerData.job.name?s.Functions.Notify("No access..","error"):s.Functions.RemoveMoney("cash",85,"Purchase News Item")?void s.Functions.AddItem("newsmic",1,!1,void 0,!0):s.Functions.Notify("Not enough cash..","error")}))},641:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0});const n=t(586),i=t(611),a=t(258),r=t(483);r.FW.Functions.CreateCallback("fw-businesses:Server:PawnHub:GetScrapItems",(async(e,s)=>{if(!n.exp["fw-config"].IsConfigReady())return s([]);const t=r.FW.Functions.GetPlayer(e);if(!t)return;if(!await(0,i.HasPlayerBusinessPermission)("PawnNGo",e,"CraftAccess"))return s([]);const o=await n.exp.ghmattimysql.executeSync("SELECT * FROM `player_inventories` WHERE `inventory` = ?",[`ply-${t.PlayerData.citizenid}`]),c=[],{allowDecayedScrap:l,scrapItems:u}=n.exp["fw-config"].GetModuleConfig("bus-pawnhub",{});if(!u||0==u.length)return s([]);for(let e=0;e<o.length;e++){const s=o[e];if(!s)continue;if(!(0,a.IsItemScrappable)(u,s.item_name))continue;const t=n.exp["fw-inventory"].CalculateQuality(s.item_name,s.createdate);if(!l&&t<=5)continue;const i=n.exp["fw-inventory"].GetItemData(s.item_name,s.customtype);c.push({Label:i.Label,Slot:s.slot,Parts:4-Math.floor((100-t)/33),Materials:Math.floor((100-t)/100*75)})}s(c)})),onNet("fw-businesses:Server:PawnHub:ScrapElectronic",(async e=>{if(!n.exp["fw-config"].IsConfigReady())return;const s=source,t=r.FW.Functions.GetPlayer(s);if(!t)return;if(!await(0,i.HasPlayerBusinessPermission)("PawnNGo",s,"CraftAccess"))return;const{scrapItems:o}=n.exp["fw-config"].GetModuleConfig("bus-pawnhub"),c=await n.exp["fw-inventory"].GetInventoryItemBySlot(`ply-${t.PlayerData.citizenid}`,e.Slot);if(!c)return;const l=(0,a.IsItemScrappable)(o,c.Item);if(!l)return;const u=(0,n.GetRandom)(l.Rewards[0],l.Rewards[1]),y=["metalscrap","plastic","aluminum","copper"];if(await t.Functions.RemoveItem(c.Item,1,e.Slot,!0))for(let s=0;s<3;s++)await(0,n.Delay)(50),t.Functions.AddItem(y[Math.floor(Math.random()*y.length)],Math.ceil(u*e.Parts*.33),!1,!1,!0,!1)}))},104:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.VehicleRegistration=void 0;const n=t(586),i=t(483),a=t(611);s.VehicleRegistration='<h3>Los Santos DMV</h3><figure class="table"><table><thead><tr><th>&nbsp;</th><th>Data</th></tr></thead><tbody><tr><th>Name</th><td>%s</td></tr><tr><th>Model</th><td>%s</td></tr><tr><th>License Plate</th><td>%s</td></tr><tr><th>Vin</th><td>%s</td></tr></tbody></table></figure><p>&nbsp;</p><h3>Ownership History</h3><figure class="table"><table><thead><tr><th>Owner</th><th>Seller</th><th>Date</th><th>Price</th></tr></thead><tbody><tr><td>%s</td><td>%s</td><td>%s</td><td>%s</td></tr></tbody></table></figure>',(0,n.exp)("GetVehicleRegistration",(()=>s.VehicleRegistration));const r=e=>n.exp["fw-config"].GetModuleConfig("bus-vehicleshop").ShopData[e],o={pdm:[{Coords:{x:-49.79,y:-1083.58,z:26.96,w:250.88},Vehicle:!1},{Coords:{x:-47.67,y:-1091.92,z:26.96,w:283.11},Vehicle:!1},{Coords:{x:-54.82,y:-1097,z:26.96,w:33.24},Vehicle:!1},{Coords:{x:-37.21,y:-1093.27,z:26.96,w:210.76},Vehicle:!1},{Coords:{x:-42.41,y:-1101.29,z:26.96,w:12.22},Vehicle:!1}],bennys:[{Coords:{x:-191.15,y:-1308.34,z:30.68,w:21.76},Vehicle:!1},{Coords:{x:-195.74,y:-1307.82,z:30.7,w:21.75},Vehicle:!1}],flightschool:[{Coords:{x:-969,y:-2934.08,z:13.66,w:183.14},Vehicle:!1},{Coords:{x:-956.49,y:-2940.2,z:13.66,w:134.18},Vehicle:!1}],lostmc:[{Coords:{x:983.51,y:-114.82,z:73.29,w:100.21},Vehicle:!1},{Coords:{x:981.72,y:-117.07,z:73.3,w:108.7},Vehicle:!1},{Coords:{x:985.26,y:-111.66,z:73.46,w:101.77},Vehicle:!1}],losmuertos:[{Coords:{x:1218.79,y:3614.03,z:33.09,w:39.16},Vehicle:!1},{Coords:{x:1222.54,y:3615.07,z:33.08,w:36.68},Vehicle:!1},{Coords:{x:1226.67,y:3615.84,z:33.08,w:38.55},Vehicle:!1}],darkwolves:[{Coords:{x:1707.66,y:4808.54,z:41.2,w:147.02},Vehicle:!1},{Coords:{x:1710.49,y:4808.31,z:41.18,w:146.5},Vehicle:!1},{Coords:{x:1713.09,y:4808.04,z:41.16,w:145.83},Vehicle:!1}]};setImmediate((async()=>{const e=["pdm","bennys","flightschool","lostmc","darkwolves","losmuertos"];for(let s=0;s<e.length;s++){const t=e[s],i=await n.exp.ghmattimysql.executeSync("SELECT `vehicle` FROM `server_vehicles` WHERE `shop` = ? AND `stock` > 0",[t]);if(0!=i.length)for(let e=0;e<o[t].length;e++)i[e]?o[t][e].Vehicle=i[e].vehicle:o[t][e].Vehicle=!1}})),i.FW.Functions.CreateCallback("fw-businesses:Server:GetVehicleShopPlacements",(async(e,s,t)=>{s(o[t])})),i.FW.Functions.CreateCallback("fw-businesses:Server:VehicleShop:GetPreset",(async(e,s,t,i)=>{const a=await n.exp.ghmattimysql.executeSync("SELECT `preset` FROM `server_vehicles` WHERE `shop` = ? AND `vehicle` = ?",[t,i]);s(a[0]&&JSON.parse(a[0].preset)||{})})),i.FW.Functions.CreateCallback("fw-businesses:Server:VehicleShop:GetShopData",(async(e,s,t)=>{s(r(t))})),i.FW.Functions.CreateCallback("fw-businesses:Server:GetCatalog",(async(e,s,t)=>{const a=await n.exp.ghmattimysql.executeSync("SELECT `vehicle` FROM `server_vehicles` WHERE `shop` = ?",[t]);let r=[];for(let e=0;e<a.length;e++){const s=i.FW.Shared.HashVehicles[GetHashKey(a[e].vehicle)];if(s){const e=i.FW.Shared.CalculateTax("Vehicle Registration Tax",s.Price);r.push({...s,Price:1.07*e})}}s(r)})),i.FW.RegisterServer("fw-businesses:Server:QuicksellVehicle",(async(e,s,t,a)=>{const r=i.FW.Functions.GetPlayer(e);if(!r)return;const o=i.FW.Shared.HashVehicles[a];if(!o)return r.Functions.Notify("This vehicle cannot be quicksold!");const c=await n.exp.ghmattimysql.executeSync("SELECT `citizenid`, `metadata`, `vinscratched` FROM `player_vehicles` WHERE `plate` = ?",[t]);if(!c[0])return r.Functions.Notify("This vehicle cannot be quicksold!");if(c[0].citizenid!=r.PlayerData.citizenid)return r.Functions.Notify("This vehicle cannot be quicksold!");if(c[0].vinscratched&&1==c[0].vinscratched)return r.Functions.Notify("This vehicle cannot be quicksold!");if(DeleteEntity(NetworkGetEntityFromNetworkId(s)),JSON.parse(c[0].metadata).Gifted)r.Functions.Notify("You sold your gift vehicle for free.");else{const[e,s]=i.FW.Shared.DeductTax("Vehicle Registration Tax",.65*o.Price);n.exp["fw-financials"].AddMoneyToAccount("1001","1",r.PlayerData.charinfo.account,e,"TRANSFER",`Vehicle quick-sell ${o.Vehicle} [${t}]`),r.Functions.Notify("Added to bank balance.")}n.exp.ghmattimysql.executeSync("DELETE FROM `player_vehicles` WHERE `plate` = ? and `citizenid` = ?",[t,r.PlayerData.citizenid])})),onNet("fw-businesses:Server:ChangeVehicle",((e,s,t)=>{o[e][s].Vehicle=t,emitNet("fw-businesses:Client:VehicleShop:SetVehicle",-1,e,s,t)})),onNet("fw-businesses:Server:VehicleShop:TestDrive",(async(e,s,t)=>{const i=await n.exp.ghmattimysql.executeSync("SELECT `stock` FROM `server_vehicles` WHERE `shop` = ? AND `vehicle` = ?",[e,s]);i[0]&&n.exp.ghmattimysql.executeSync("UPDATE `server_vehicles` SET `stock` = ? WHERE `shop` = ? AND `vehicle` = ?",[t?i[0].stock+1:i[0].stock-1,e,s])})),onNet("fw-businesses:Server:VehicleShop:SellVehicle",(async(e,s,t)=>{const o=source;if(!i.FW.Functions.GetPlayer(o))return;const c=i.FW.Functions.GetPlayerByCitizenId(s.Cid);if(!c)return;const l=r(e.Shop);l&&await(0,a.HasPlayerBusinessPermission)(l.BusinessName,o,"VehicleSales")&&emitNet("fw-phone:Client:Notification",c.PlayerData.source,`purchase-vehicle-${s.Cid}`,"fas fa-car",["white","rgb(38, 50, 56)"],"Buy Vehicle",`${(0,n.NumberWithCommas)(Number(s.Amount))} incl. tax`,!1,!0,"fw-businesses:Server:VehicleShop:Purchase","fw-phone:Client:RemoveNotificationById",{Id:`purchase-vehicle-${s.Cid}`,Cid:s.Cid,Seller:o,Business:e.Shop,Amount:s.Amount,NetId:t,Model:e.Vehicle})})),onNet("fw-businesses:Server:VehicleShop:Purchase",(e=>{const t=source,o=i.FW.Functions.GetPlayer(t);if(!o)return;const c=i.FW.Functions.GetPlayer(e.Seller);if(!c)return;const l=i.FW.Shared.HashVehicles[GetHashKey(e.Model)];if(!l)return;const u=r(e.Business);emitNet("fw-phone:Client:UpdateNotification",t,e.Id,!0,!0,!1,"Buying...",!0),setTimeout((async()=>{const r=await(0,a.GetBusinessAccount)(u.BusinessName);if(!await n.exp["fw-financials"].RemoveMoneyFromAccount(c.PlayerData.citizenid,r,o.PlayerData.charinfo.account,e.Amount,"PURCHASE",`Business service payment: ${e.Model} purchased!`))return void emitNet("fw-phone:Client:UpdateNotification",t,e.Id,!0,!0,!1,"Transaction Denied!",!0);emitNet("fw-phone:Client:UpdateNotification",t,e.Id,!0,!0,!1,"Transaction completed!",!0);const y=await i.FW.Functions.GeneratePlate(),m=await i.FW.Functions.GenerateVin();n.exp.ghmattimysql.executeSync("INSERT INTO `player_vehicles` (`citizenid`, `vehicle`, `plate`, `state`, `vinnumber`) VALUES (?, ?, ?, 'out', ?)",[o.PlayerData.citizenid,e.Model,y,m]),n.exp.ghmattimysql.executeSync("INSERT INTO `vehicles_ownership` (seller, buyer, plate, price, timestamp) VALUES (?, ?, ?, ?, ?)",[u.BusinessName,c.PlayerData.citizenid,y,e.Amount,(new Date).getTime()]);const f=new Date,d=f.getFullYear(),h=f.getMonth(),p=f.getDate(),S=f.getHours(),w=f.getMinutes(),g=e.Amount-l.Price;n.exp["fw-financials"].AddMoneyToAccount(c.PlayerData.citizenid,c.PlayerData.charinfo.account,r,l.Price+Math.min(g,.05*l.Price),"PURCHASE",`Business service payment: ${e.Model} [${y}] sold!`),emit("fw-logs:Server:Log",e.Business,"Vehicle Sold",`User: [${c.PlayerData.source}] - ${c.PlayerData.citizenid} - ${c.PlayerData.charinfo.firstname} ${c.PlayerData.charinfo.lastname}\nBuyer: [${o.PlayerData.source}] - ${o.PlayerData.citizenid} - ${o.PlayerData.charinfo.firstname} ${o.PlayerData.charinfo.lastname}\nModel: ${e.Model} [${y}]\nSold Price: ${(0,n.NumberWithCommas)(e.Amount)}\nRetail Price: ${(0,n.NumberWithCommas)(l.Price)}`,"green");let C=[l.Name,e.Model,y,m,`${o.PlayerData.charinfo.firstname} ${o.PlayerData.charinfo.lastname}`,`${c.PlayerData.charinfo.firstname} ${c.PlayerData.charinfo.lastname}`,`${p}/${h}/${d} ${S}:${w}`,(0,n.NumberWithCommas)(Number(e.Amount))];emitNet("fw-businesses:Client:VehicleShop:LoadVehicle",t,e.NetId,y),emitNet("fw-phone:Client:Cars:SetTestDrive",c.PlayerData.source,!1),emit("fw-phone:Server:Documents:AddDocument","1001",{Type:3,Title:`${l.Name} - ${y}`,Content:s.VehicleRegistration.replace(/%s/g,(()=>C.shift()||"")),Signatures:[{Signed:!0,Name:"The State",Timestamp:f.getTime(),Cid:"1001"},{Signed:!0,Name:`${o.PlayerData.charinfo.firstname} ${o.PlayerData.charinfo.lastname}`,Timestamp:f.getTime(),Cid:o.PlayerData.citizenid}],Sharees:[o.PlayerData.citizenid],Finalized:1})}),1e3)})),onNet("fw-businesses:Server:VehicleShop:SetPreset",(async(e,s,t)=>{const o=source;if(!i.FW.Functions.GetPlayer(o))return;const c=r(e);c&&await(0,a.HasPlayerBusinessPermission)(c.BusinessName,o,"ChargeExternal")&&n.exp.ghmattimysql.executeSync("UPDATE `server_vehicles` SET `preset` = ? WHERE `shop` = ? AND `vehicle` = ?",[JSON.stringify(t),e,s])}))},483:function(e,s,t){var n=this&&this.__createBinding||(Object.create?function(e,s,t,n){void 0===n&&(n=t);var i=Object.getOwnPropertyDescriptor(s,t);i&&!("get"in i?!s.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return s[t]}}),Object.defineProperty(e,n,i)}:function(e,s,t,n){void 0===n&&(n=t),e[n]=s[t]}),i=this&&this.__setModuleDefault||(Object.create?function(e,s){Object.defineProperty(e,"default",{enumerable:!0,value:s})}:function(e,s){e.default=s}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var s={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&n(s,e,t);return i(s,e),s};Object.defineProperty(s,"__esModule",{value:!0}),s.FW=void 0;const r=t(586);s.FW=r.exp["fw-core"].GetCoreObject();const o=a(t(585)),c=a(t(611));(0,c.default)(),setImmediate((()=>{(0,o.default)()})),s.FW.Functions.CreateCallback("fw-businesses:Server:PayExternal",(async(e,t,n,i,a,o)=>{const l=s.FW.Functions.GetPlayer(e);if(!l)return;const u=await(0,c.GetBusinessByName)(n);if(!u)return t({Success:!1,Msg:"Invalid business."});if(!(0,c.HasPlayerBusinessPermission)(n,e,"PayExternal"))return t({Success:!1,Msg:"No access."});if(!u.business_account)return t({Success:!1,Msg:"No bank account linked to business."});const y=await r.exp.ghmattimysql.executeSync("SELECT `citizenid`, `charinfo` FROM `players` WHERE `citizenid` = ?",[i]);if(!y[0])return t({Success:!1,Msg:"Invalid player."});const m=JSON.parse(y[0].charinfo);if(await r.exp["fw-financials"].RemoveMoneyFromAccount(i,m.account,u.business_account,Number(a),"PAY",`Pay External: ${o||"No comment."}`,!1))return r.exp["fw-financials"].AddMoneyToAccount(i,l.PlayerData.charinfo.account,m.account,Number(a),"PAY",`Pay External: ${o||"No comment."}`),t({Success:!0});t({Success:!1,Msg:"Not enough balance on business account."})})),s.FW.Functions.CreateCallback("fw-businesses:Server:ChargeCustomer",(async(e,t,n,i,a,o)=>{if(!s.FW.Functions.GetPlayer(e))return;const l=await(0,c.GetBusinessByName)(n);if(!l)return t({Success:!1,Msg:"Invalid business."});if(!(0,c.HasPlayerBusinessPermission)(n,e,"ChargeExternal"))return t({Success:!1,Msg:"No access."});if(!l.business_account)return t({Success:!1,Msg:"No bank account linked to business."});const u=s.FW.Functions.GetPlayerByCitizenId(i);if(!u)return t({Success:!1,Msg:"Invalid player."});const y=s.FW.Shared.CalculateTax("Services",Number(a));emitNet("fw-phone:Client:Notification",u.PlayerData.source,`charge-customer-${i}`,"fas fa-donate",["white","rgb(38, 50, 56)"],"Business Invoice",`${(0,r.NumberWithCommas)(Number(y))} - ${n} - ${o||"No comment."}`,!1,!0,"fw-businesses:Server:AcceptCharge","fw-businesses:Server:RejectCharge",{Id:`charge-customer-${i}`,Account:l.business_account,Cid:i,Charger:e,Business:n,Amount:Number(a),Comment:o||"No comment."}),t({Success:!0})})),s.FW.Functions.CreateCallback("fw-businesses:Server:GetClockedInEmployees",((e,t,n)=>{let i=[];for(const[t,a]of Object.entries(o.ClockedPlayers))if(a.ClockedIn&&a.Business==n){const t=s.FW.Functions.GetPlayer(e);t&&i.push({Cid:t.PlayerData.citizenid,Name:`${t.PlayerData.charinfo.firstname} ${t.PlayerData.charinfo.lastname}`,TimeClockedIn:GetGameTimer()-a.ClockInTime})}t(i)})),onNet("fw-businesses:Server:AcceptCharge",(async e=>{const t=source,n=s.FW.Functions.GetPlayer(t);if(!n)return;const i=s.FW.Functions.GetPlayer(e.Charger);if(!i)return;const a=s.FW.Shared.CalculateTax("Services",e.Amount);await r.exp["fw-financials"].RemoveMoneyFromAccount(i.PlayerData.citizenid,e.Account,n.PlayerData.charinfo.account,a,"PURCHASE",`Business service payment: ${e.Comment}`,!1)?(r.exp["fw-financials"].AddMoneyToAccount(n.PlayerData.citizenid,n.PlayerData.charinfo.account,e.Account,e.Amount,"PURCHASE",`Business service payment: ${e.Comment}`),emitNet("fw-phone:Client:Notification",e.Charger,`business-charge-${e.Cid}`,"fas fa-home",["white","rgb(38, 50, 56)"],"Business Invoice","Payment Completed!"),emitNet("fw-phone:Client:UpdateNotification",t,e.Id,!0,!0,!1,"Payment Completed!",!0),r.exp["fw-financials"].AddMoneyToAccount("1001","1","1",a-e.Amount,"TAX",`${e.Business} invoice paid: ${e.Comment}`)):(emitNet("fw-phone:Client:Notification",e.Charger,`business-charge-${e.Cid}`,"fas fa-home",["white","rgb(38, 50, 56)"],"Business Invoice","Payment Denied!"),emitNet("fw-phone:Client:UpdateNotification",t,e.Id,!0,!0,!1,"Payment Denied!",!0))})),onNet("fw-businesses:Server:RejectCharge",(e=>{const s=source;emitNet("fw-phone:Client:Notification",e.Charger,`business-charge-${e.Cid}`,"fas fa-home",["white","rgb(38, 50, 56)"],"Business Invoice","Payment Denied!"),emitNet("fw-phone:Client:UpdateNotification",s,e.Id,!0,!0,!1,"Payment Denied!",!0)})),onNet("fw-businesses:Server:CreateBusiness",(async e=>{const t=source,n=s.FW.Functions.GetPlayer(t);n&&("judge"!=n.PlayerData.job.name&&"mayor"!=n.PlayerData.job.name||(await r.exp.ghmattimysql.executeSync("INSERT INTO `phone_businesses` (`business_owner`, `business_name`, `business_account`) VALUES (?, ?, ?)",[e.BusinessOwner,e.BusinessName,e.BusinessAccount]),n.Functions.Notify(`Business [${e.BusinessName}] successfully created!`,"success")))}))},611:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IsClockedIn=s.HasPlayerBusinessPermission=s.GetBusinessOwner=s.GetBusinessByName=s.GetBusinessAccount=s.GetPlayerNameByCid=void 0;const n=t(586),i=t(585),a=t(483);s.GetPlayerNameByCid=async e=>{const s=a.FW.Functions.GetPlayerByCitizenId(e);if(s)return`${s.PlayerData.charinfo.firstname} ${s.PlayerData.charinfo.lastname}`;const t=await n.exp.ghmattimysql.executeSync("SELECT `charinfo` FROM `players` WHERE `citizenid` = ?",[e]);if(!t[0])return"";const i=JSON.parse(t[0].charinfo);return`${i.firstname} ${i.lastname}`},s.GetBusinessAccount=async e=>{const s=await n.exp.ghmattimysql.executeSync("SELECT `business_account` FROM `phone_businesses` WHERE `business_name` = ?",[e]);return s[0]?s[0].business_account:0},s.GetBusinessByName=async e=>{const s=await n.exp.ghmattimysql.executeSync("SELECT * FROM `phone_businesses` WHERE `business_name` = ?",[e]);return!!s[0]&&s[0]},s.GetBusinessOwner=async e=>{var s;const t=await n.exp.ghmattimysql.executeSync("SELECT `business_owner` FROM `phone_businesses` WHERE `business_name` = ?",[e]);return!!t[0]&&(null===(s=t[0])||void 0===s?void 0:s.business_owner)},s.HasPlayerBusinessPermission=async(e,t,n)=>{const i=a.FW.Functions.GetPlayer(t);if(!i)return!1;const r=await(0,s.GetBusinessByName)(e);if(!r)return!1;if(r.business_owner==i.PlayerData.citizenid)return!0;const o=JSON.parse(r.business_employees),c=JSON.parse(r.business_ranks);for(let e=0;e<o.length;e++){const s=o[e];if(s.Cid!=i.PlayerData.citizenid)continue;const t=c.find((e=>e.Name==s.Role));if(!t)return!1;if(t.Perms[n])return!0}return!1},s.IsClockedIn=(e,s)=>!!i.ClockedPlayers[e]&&i.ClockedPlayers[e].ClockedIn&&i.ClockedPlayers[e].Business==s,s.default=()=>{(0,n.exp)("GetBusinessAccount",s.GetBusinessAccount),(0,n.exp)("HasPlayerBusinessPermission",s.HasPlayerBusinessPermission),(0,n.exp)("GetBusinessOwner",s.GetBusinessOwner)}},586:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.NumberWithCommas=s.Round=s.RegisterNUICallback=s.SetUIFocus=s.SendUIMessage=s.GetRandom=s.Delay=s.exp=void 0,s.exp=t.g.exports,s.Delay=e=>new Promise((s=>setTimeout(s,e))),s.GetRandom=(e,s)=>Math.floor(Math.random()*(s-e+1))+e,s.SendUIMessage=IsDuplicityVersion()?()=>console.warn("SendUIMessage does exist on server."):(e,t,n)=>{s.exp["fw-ui"].SendUIMessage(e,t,n)},s.SetUIFocus=IsDuplicityVersion()?()=>console.warn("SetUIFocus does exist on server."):(e,t)=>{s.exp["fw-ui"].SetUIFocus(e,t)},s.RegisterNUICallback=IsDuplicityVersion()?()=>console.log("RegisterNUICallback can't be used on server."):(e,s)=>{RegisterNuiCallbackType(e),on(`__cfx_nui:${e}`,s)},s.Round=(e,s)=>s?Math.floor(e*10**s+.5)/10**s:Math.floor(e+.5),s.NumberWithCommas=e=>new Intl.NumberFormat("nl-NL",{style:"currency",currency:"EUR"}).format(e),(0,s.exp)("NumberWithCommas",s.NumberWithCommas)}},s={};function t(n){var i=s[n];if(void 0!==i)return i.exports;var a=s[n]={exports:{}};return e[n].call(a.exports,a,a.exports,t),a.exports}t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t(483)})();